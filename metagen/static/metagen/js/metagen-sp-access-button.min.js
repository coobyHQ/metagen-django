jQuery && function(t) {
    function i(i, n) {
        var d = i ? t(this) : n,
            o = t(d.attr("metagen-idp-button")),
            r = d.hasClass("metagen-idp-button-open")
        if (i) {
            if (t(i.target).hasClass("metagen-idp-button-ignore")) return
            i.preventDefault(), i.stopPropagation()
        } else if (d !== n.target && t(n.target).hasClass("metagen-idp-button-ignore")) return
        s(), r || d.hasClass("metagen-idp-button-disabled") || (d.addClass("metagen-idp-button-open"), o.data("metagen-idp-button-trigger", d).show(), e(), o.trigger("show", {
            metagenIDPButton: o,
            trigger: d
        }))
    }

    function s(i) {
        var s = i ? t(i.target).parents().addBack() : null
        if (s && s.is(".metagen-idp-button")) {
            if (!s.is(".metagen-idp-button-menu")) return
            if (!s.is("A")) return
        }
        t(document).find(".metagen-idp-button:visible").each(function() {
            var i = t(this)
            i.hide().removeData("metagen-idp-button-trigger").trigger("hide", {
                metagenIDPButton: i
            })
        }), t(document).find(".metagen-idp-button-open").removeClass("metagen-idp-button-open")
    }

    function e() {
        var i = t(".metagen-idp-button:visible").eq(0),
            s = i.data("metagen-idp-button-trigger"),
            e = s ? parseInt(s.attr("data-horizontal-offset") || 0, 10) : null,
            n = s ? parseInt(s.attr("data-vertical-offset") || 0, 10) : null
        0 !== i.length && s && (i.hasClass("metagen-idp-button-relative") ? i.css({
            left: i.hasClass("metagen-idp-button-anchor-right") ? s.position().left - (i.outerWidth(!0) - s.outerWidth(!0)) - parseInt(s.css("margin-right"), 10) + e : s.position().left + parseInt(s.css("margin-left"), 10) + e,
            top: s.position().top + s.outerHeight(!0) - parseInt(s.css("margin-top"), 10) + n
        }) : i.css({
            left: i.hasClass("metagen-idp-button-anchor-right") ? s.offset().left - (i.outerWidth() - s.outerWidth()) + e : s.offset().left + e,
            top: s.offset().top + s.outerHeight() + n
        }))
    }
    t.extend(t.fn, {
        metagenIDPButton: function(e, n) {
            switch (e) {
                case "show":
                    return i(null, t(this)), t(this)
                case "hide":
                    return s(), t(this)
                case "attach":
                    return t(this).attr("metagen-idp-button", n)
                case "detach":
                    return s(), t(this).removeAttr("metagen-idp-button")
                case "disable":
                    return t(this).addClass("metagen-idp-button-disabled")
                case "enable":
                    return s(), t(this).removeClass("metagen-idp-button-disabled")
            }
        }
    }), t(document).on("click.metagen-idp-button", "[metagen-idp-button]", i), t(document).on("click.metagen-idp-button", s), t(window).on("resize", e)
}(jQuery)
